// Generated by CoffeeScript 1.6.3
var addViewport,address,browse,generateQueryString,getParameterByName,height,heightArray,mainViewport,removeViewport,requestAddress,resetSizeArrays,setDefaults,width,widthArray;address=null;height=null;width=null;heightArray=[];widthArray=[];mainViewport=null;requestAddress="request.php?uri=";browse=function(e){var t,n,r,i;n=new RegExp("http://");i=new RegExp("https://");if(!n.test(e)||i.test(e))e="http://"+e;r=new RegExp(/\/#/);while(r.test(e))e=e.replace(/\/#/,"");$("#address").val(e);t=0;$(".viewport").each(function(){var n;n=$(this).find("iframe");n.attr("src",""+requestAddress+e+"&index="+t);n.css({height:$(this).find(".height").val(),width:$(this).find(".width").val()});$(this).find(".iframe-preloader").css({height:$(this).find(".height").val(),width:$(this).find(".width").val()});return t++});$(".viewport").each(function(){var e;e=$(this).find("iframe");return e.attr("src",e.attr("scr"))});return generateQueryString()};getParameterByName=function(e){var t,n;e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+e+"=([^&#]*)");n=t.exec(location.search);return n===null?"":decodeURIComponent(n[1].replace(/\+/g," "))};setDefaults=function(){var e,t,n,r,i,s,o;address=getParameterByName("address");height=getParameterByName("height");width=getParameterByName("width");address!==""?$("#address").val(address):address=$("#address").val();if(height!==""&&width!==""){n=height.split(",");r=width.split(",");if(n.length===r.length){heightArray=n;widthArray=r}else{height=mainViewport.find(".height").val();heightArray.push(height);i=mainViewport.find(".width").val();widthArray.push(width)}}else{height=mainViewport.find(".height").val();heightArray.push(height);width=mainViewport.find(".width").val();widthArray.push(width)}if(widthArray.length>1&&heightArray.length>1)for(t=s=1,o=widthArray.length-1;1<=o?s<=o:s>=o;t=1<=o?++s:--s)addViewport();e=0;$(".viewport").each(function(){$(this).find(".height").val(heightArray[e]);$(this).find(".width").val(widthArray[e]);return e++});browse(address)};addViewport=function(e){var t,n,r;e==null&&(e=!1);n=mainViewport.clone();$(".main-container").append(n);if(e){r=$("#size-selector").val();t=r.split("|");n.find(".height").val(t[0]);n.find(".width").val(t[1]);n.find("iframe").css({height:t[0],width:t[1]});n.find(".iframe-preloader").css({height:t[0],width:t[1]});heightArray.push(t[0]);widthArray.push(t[1]);generateQueryString()}};generateQueryString=function(){var e,t,n;resetSizeArrays();n=window.location.protocol+"//"+window.location.host+window.location.pathname;e=[];e.push("address="+address);e.push("width="+widthArray.join(","));e.push("height="+heightArray.join(","));t=e.join("&");n=""+n+"?"+t;window.history.pushState("","Responsive Tool",n)};resetSizeArrays=function(){heightArray=[];widthArray=[];$(".viewport").each(function(){var e;e=$(this).find("iframe");heightArray.push($(this).find(".height").val());return widthArray.push($(this).find(".width").val())});address=$("#address").val()};removeViewport=function(e){if($(".viewport").length>1){e.remove();generateQueryString()}else alert("Cant remove all viewports")};window.finishedLoad=function(e){$(".viewport").eq(e).find(".iframe-preloader").addClass("hide");setTimeout(function(){return $("iframe").each(function(){return $(this).contents().find("body").scrollTop(0)})},500)};$(function(){mainViewport=$(".viewport").eq(0);setDefaults();$("#submit").click(function(){return browse($("#address").val())});$("#new").click(function(){return addViewport(!0)});$("body").on("click",".remove",function(){return removeViewport($(this).parent().parent())});return $(window).on("click","a",function(){return console.log(this)})});